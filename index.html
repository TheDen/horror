<html>
	<head>
		<link rel="stylesheet" type="text/css" href="style.css" />
		<script src="blotter.min.js"></script>
		<script src="liquidDistortMaterial.js"></script>
		<script>
			document.addEventListener("click", function() {
				music = new Audio("noise.mp3");
				music.play();
			}, {once : true});
		</script>
		<script>
			window.onload = function() {
				setTimeout(function() {
					document.getElementById("content").style.opacity = 1;
				}, 400);
			};
		</script>

	</head>
	<body>
		<div id="light"></div>
		<div id="content">
			<div id="beware"></div>
			<p>1. The Industrial Revolution and its consequences have
				been a disaster for the human race. They have greatly
				increased the life-expectancy of those of us who live in
				“advanced” countries, but they have destabilized society,
				have made life unfulfilling, have subjected human beings
				to indignities, have led to widespread psychological suffering (in the Third World to physical suffering as well) and
				have inflicted severe damage on the natural world. The
				continued development of technology will worsen the situation. It will certainly subject human being to greater indignities and inflict greater damage on the natural world,
				it will probably lead to greater social disruption and psychological suffering, and it may lead to increased physical
				suffering even in “advanced” countries</p>
		</div>
		<div id="hidden"></div>
		<div id="distortion-text"></div>
	</body>
	<script>
		function jitter() {
			light.style.filter= "brightness(0.2)";
		}
		function nojitter() {
			light.style.filter = "brightness(1)";
		}

		function start() {
			max = 12000;
			min = 20000;
			wait = Math.random() * (max - min) + min;
			setTimeout(jitter, wait);
			setTimeout(nojitter, wait+200);
			setTimeout(start, 5000);
		}

		var light = document.querySelector("#light")
		var body = document.querySelector("body")
		start();
	</script>

	<script>
		function getRandomInt(min, max) {
			min = Math.ceil(min);
			max = Math.floor(max);
			return Math.floor(Math.random() * (max - min + 1)) + min;
		}
		function sleep (time) {
			return new Promise((resolve) => setTimeout(resolve, time));
		}
		function first() {
			setTimeout(function() {
				hidden = document.getElementById("hidden");
				boo_image = `url(\"boo-${getRandomInt(1,4)}.jpg\")`
				hidden.style.backgroundImage = boo_image;
				hidden.style.filter = "brightness(5)";
				hidden.style.width = "100vw"
				hidden.style.height = "100vh"
				light.style.display = "none"
				second();
			},10000);
		}
		function second() {
			sleep(2000).then(() => {
				hidden = document.getElementById("hidden");
				hidden.style.filter = "brightness(0)";
				hidden.style.width = "0px"
				hidden.style.height = "0px"
				light.style.display = "revert"
			});
		}
		first();
	</script>
	<script>
		var timeout;
		var body = document.querySelector("body")
		document.onmousemove = function(event) {
			light = document.getElementById("light")
			pos = light.getBoundingClientRect()
			document.getElementById("light").style.top = event.pageY  - 50
			document.getElementById("light").style.left = event.pageX - 50
			body.classList.remove("blurout")
			body.classList.add("blurin")
			clearTimeout(timeout);
			timeout = setTimeout(function(){
				body.style.filter = "blur(0.8px)"
				body.classList.remove("blurin")
				body.classList.add("blurout")
			}, 400);
		}
	</script>
	<script>
		document.fonts.ready.then(function () {
			function sleep (time) {
				return new Promise((resolve) => setTimeout(resolve, time));
			}
			function first() {
				setTimeout(function() {
					content = "I See you"
					var text = new Blotter.Text(content, {
						family : "zodiac",
						size : 200,
						fill : "#000",
						paddingLeft : 0,
						paddingRight : 0
					});
					var material = new Blotter.LiquidDistortMaterial();
					material.uniforms.uSpeed.value = 0.23;
					material.uniforms.uVolatility.value = 0.01;
					var blotter = new Blotter(material, {
						texts : text
					});
					var elem = document.getElementById("distortion-text");
					var scope = blotter.forText(text);
					scope.appendTo(elem);
					second();
				},10000);
			}
			function second() {
				sleep(15000).then(() => {
					document.getElementById("distortion-text").classList.add("hide")
				});
			}
			first();
			var text2 = new Blotter.Text("BEWARE", {
				family : "zodiac",
				size : 60,
				fill : "#000",
				paddingLeft : 40,
				paddingRight : 40
			});
			var material2 = new Blotter.LiquidDistortMaterial();
			material2.uniforms.uSpeed.value = 0.23;
			material2.uniforms.uVolatility.value = 0.01;
			var blotter2 = new Blotter(material2, {
				texts : text2
			});
			var elem2 = document.getElementById("beware");
			var scope2 = blotter2.forText(text2);
			scope2.appendTo(elem2);
		});

	</script>
</html>
